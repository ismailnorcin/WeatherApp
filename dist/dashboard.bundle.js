(()=>{"use strict";let t={title:"Anasayfa",breadcrumbCover:"",breadcrumb:"",form:"",formLat:"",formLang:"",formMessage:"",extra:{myLocationsCount:"#myLocationsCount",lastLocation:"#lastLocation",lastLocationCoordinates:"#coordinates",selectLocation:"#selectLocation",selectedLocation:"#selectedLocation",weatherResultArea:"#weatherResultArea",resultArea:"#resultArea"}};class e{constructor(t){this._pageTitle=t.title,this._pageBreadcrumbItem='<li class="breadcrumb-item"><a href="#">App</a></li>'+t.breadcrumb,this._pageBreadcrumbCover=t.breadcrumbCover,this._formMessage=t.formMessage,this._form=t.form,this._formLatitude=t.formLat,this._formLongitude=t.formLang,this._extra=t.extra}get title(){return this._pageTitle}get message(){return this._formMessage}get extra(){return this._extra}get breadcrumbCover(){return document.querySelector(this._pageBreadcrumbCover)}get breadcrumbItem(){return this._pageBreadcrumbItem}get form(){return document.querySelector(this._form)}get formLat(){return document.querySelector(this._formLatitude)}get formLong(){return document.querySelector(this._formLongitude)}}class r{constructor(t){this._api=t}url(){let{baseUrl:t,latitude:e,longitude:r}=this._api;return`${t}?latitude=${e}&longitude=${r}&daily=temperature_2m_max,temperature_2m_min&current_weather=true&timezone=auto`}fetch(){let t,e=new XMLHttpRequest;return e.open("GET",this.url(),!1),e.onreadystatechange=()=>{4==e.readyState&&200==e.status&&(t=e.response)},e.onerror=()=>{throw new Error("Error 1")},e.send(),t}getResult(){try{let t=JSON.parse(this.fetch());return{now:{temperature:t.current_weather.temperature,date:t.current_weather.time,temperatureType:t.daily_units.temperature_2m_max},dailiy:{temperaturesMax:t.daily.temperature_2m_max,temperaturesMin:t.daily.temperature_2m_min,dates:t.daily.time,temperatureType:t.daily_units.temperature_2m_max}}}catch(t){return"error"}}}class o{constructor(t,e){this._baseUrl="https://api.open-meteo.com/v1/forecast",this._latitude=t,this._longitude=e}get baseUrl(){return this._baseUrl}get latitude(){return this._latitude}get longitude(){return this._longitude}}const a=document.querySelector(t.extra.myLocationsCount),n=document.querySelector(t.extra.lastLocation),i=document.querySelector(t.extra.lastLocationCoordinates),l=document.querySelector(t.extra.selectLocation),s=document.querySelector(t.extra.selectedLocation),u=document.querySelector(t.extra.resultArea);let c=new class{constructor(){this._data="data",this._locations="locations"}updateData(t){throw new Error("Method not implemented.")}supportStorageType(){return!!window.localStorage&&"function"==typeof localStorage.getItem&&"function"==typeof localStorage.setItem&&"function"==typeof localStorage.removeItem}connectDb(){if(this.supportStorageType())return window.localStorage;throw new Error("Method not implemented.")}getLocation(t){let e=this.connectDb(),r=e.getItem(this._data)?e.getItem(this._data):JSON.stringify([]);return 0===t?JSON.parse(r):JSON.parse(r).filter((e=>e.id==t))}insertLocation(t){let e=this.connectDb();return console.log(e),!0}updateLocation(t){throw new Error("Method not implemented.")}deleteLocation(t){throw new Error("Method not implemented.")}insertBatchLocation(t){throw new Error("Method not implemented.")}updateBatchLocation(t){throw new Error("Method not implemented.")}deleteBatchLocation(t){throw new Error("Method not implemented.")}insertData(t){let e,r=this.connectDb(),o=r.getItem(this._data);e=null!==o?JSON.parse(o):[];let a=e.length,n=a>0?e[a-1].id:0;const i={id:Number(n)+1,latitude:t.latitude,longitude:t.longitude,location:t.location};e.push(i),r.setItem(this._data,JSON.stringify(e))}deleteData(t){let e=this.connectDb(),r=e.getItem(this._data);if(null!==r){let o=JSON.parse(r);o.forEach(((e,r)=>{e.id===t&&o.splice(r,1)})),e.setItem(this._data,JSON.stringify(o))}}},d=c.getLocation(0);const m=new class{constructor(t){this._page=new e(t)}setTitle(){return document.title=this._page.title,this}setBreadcrumb(){let t=(new DOMParser).parseFromString(this._page.breadcrumbItem,"text/html").body.childNodes;return Array.from(t).forEach((t=>{var e;null===(e=this._page.breadcrumbCover)||void 0===e||e.appendChild(t)})),this}page(){return this._page}}(t);window.onload=()=>{let t=d.length;a.textContent=t.toString(),n.textContent=d[t-1].location,i.textContent=d[t-1].latitude+" / "+d[t-1].longitude,h()};const h=()=>{d.forEach((t=>{let e=document.createElement("option");e.value=t.id.toString(),e.text=t.location.toString(),l.appendChild(e)}))};l.addEventListener("change",(t=>{let e=t.target.value,a=c.getLocation(Number(e));s.removeAttribute("style"),s.style.display="inline-block !important",s.querySelector("h6").textContent=a[0].location,s.querySelector("p").textContent=`${a[0].latitude}, ${a[0].longitude}`;let n=new r(new o(a[0].latitude,a[0].longitude)).getResult();"error"!==n?u.querySelector("pre").textContent=JSON.stringify(n,null,60):alert("Bilgi alınamıyor")})),m.setTitle()})();